"id","priority","phase","area","title","description","acceptance_criteria","test_mcp","review_initial_requirements","review_regression_requirements","dev_state","review_initial_state","review_regression_state","git_state","owner","refs","notes"
"PMB-000","P0","0","both","基础设施搭建","搭建 Go/Gin 服务端骨架、JWT 鉴权中间件、DB 连接；客户端新增 SelfRequest 通道和登录/注册 UI","1) POST /auth/register 返回 JWT；2) POST /auth/login 返回 JWT；3) JWT 中间件拦截未授权请求返回 code!=0；4) SelfRequest 携带 Bearer Token 成功请求受保护接口","AUTOE2E","JWT 密钥管理安全性；SelfRequest 不干扰原有 Request","注册/登录/鉴权全链路回归；Token 过期场景","已完成","已完成","未开始","已提交","","server/handler/auth.go:1;server/middleware/auth.go:1;plan/2026-02-24_13-59-21-pilminusb-migration.md:36","Phase 0 已上线"
"PMB-010","P0","1","both","稍后再看迁移","实现稍后再看 CRUD 四个接口及连播列表分流，服务端代理查询 B 站视频元信息并缓存","1) GET toview/web 返回与官方一致 JSON；2) add/dels/clear 操作后列表正确；3) 连播列表 type=0 走自建服务器；4) 添加视频后元数据自动填充","AUTOE2E","元数据代理缓存策略；UNIQUE 冲突处理（重复添加 → 更新 added_at）","批量删除边界（空列表/全删）；清空三种 clean_type；视频失效占位","已完成","已完成","未开始","已提交","","server/handler/watch_later.go:1;server/model/watch_later.go:1;plan/2026-02-24_13-59-21-pilminusb-migration.md:37","Phase 1 已上线"
"PMB-020","P0","2","both","观看历史迁移","实现历史游标分页、搜索、删除、清空、暂停/恢复、heartbeat 进度上报、进度查询共 10 个端点","1) history/cursor 游标分页与官方格式一致；2) heartbeat 上报后 progress/view_at 更新；3) 暂停状态下不写入；4) bvid→aid 自动解析；5) history/progress 返回 last_play_time(ms)","AUTOE2E","heartbeat 高频写入性能；bvid→aid 缓存；游标分页边界","暂停→恢复→上报全链路；搜索中文；并发 heartbeat；进度恢复准确","已完成","已完成","未开始","已提交","","server/handler/history.go:1;server/model/watch_history.go:1;plan/2026-02-24_13-59-21-pilminusb-migration.md:38","Phase 2 已上线，含 progress 端点"
"PMB-030","P0","3.1","backend","收藏夹服务端 — 模型与文件夹管理","创建 model/favorite.go (FavFolder + FavResource)，实现收藏夹 CRUD 7 个端点：list-all/list/info/add/edit/del/sort","1) AutoMigrate 建表成功；2) 创建文件夹返回含 media_id 的 JSON；3) list-all 支持 rid 参数查询视频所属夹；4) 删除文件夹同时删除其下所有收藏内容；5) sort 接口按传入顺序写入 sort_order","AUTOSERVER","MediaID 自增分配策略（用户级 MAX+1）；首个文件夹自动标记 is_default=1；响应格式与 B 站一致","文件夹 CRUD 全操作回归；排序后列表顺序验证；并发创建不产生 MediaID 冲突","已完成","待验收","未开始","已提交","","plan/2026-02-24_13-59-21-pilminusb-migration.md:70-127;PLAN.md:383-399","model/favorite.go + handler/favorite.go + main.go routes registered; go build OK"
"PMB-040","P0","3.2","backend","收藏夹服务端 — 内容管理与交叉操作","实现收藏内容管理 7 个端点 + 稍后再看交叉操作 2 个端点，共 9 个","1) batch-deal 事务内同时 add 和 del 成功；2) copy/move 跨文件夹后源/目标 media_count 正确；3) toview/copy 从稍后再看复制到收藏夹；4) toview/move 复制后从稍后再看删除；5) media_count 始终与实际 COUNT 一致","AUTOSERVER","batch-deal 使用 DB 事务保证原子性；media_count 通过 COUNT 查询维护而非增量；元数据复用 bilibili.FetchVideoInfo 缓存","跨文件夹批量操作原子性；清空后 media_count=0；与 Phase 1 稍后再看交叉操作回归","已完成","待验收","未开始","已提交","","plan/2026-02-24_13-59-21-pilminusb-migration.md:128-155;PLAN.md:400-460","All 9 endpoints implemented in handler/favorite.go (same file as PMB-030)"
"PMB-050","P0","3.3","frontend","收藏夹客户端迁移","fav.dart 中 ~13 个视频收藏方法从 Request() → SelfRequest()，移除 csrf/AppSign","1) allFavFolders/userfavFolder/favFolderInfo 正常获取数据；2) addOrEditFolder/deleteFolder 操作后 UI 刷新正确；3) favVideo (batch-deal) 收藏/取消后状态正确；4) copyOrMoveFav 含稍后再看场景正常；5) 不迁移方法（PUGV/话题/专栏/笔记）仍走 Request 不受影响","AUTOE2E","仅改 Request→SelfRequest + 移除 csrf/AppSign，不改方法签名和返回类型；不迁移的方法必须保持原样","全部 13 个方法端到端联调；不迁移方法无回归；收藏夹页面 UI 完整流程","已完成","待验收","未开始","已提交","","plan/2026-02-24_13-59-21-pilminusb-migration.md:156-192;PiliMinusB/lib/http/fav.dart:1","13 methods Request→SelfRequest in fav.dart; removed csrf/AppSign; server unfavAll/sort param names aligned"
"PMB-060","P1","4.1","backend","关注管理服务端","创建 model/follow.go (Following + FollowTag + FollowTagMember)，实现关注列表与分组管理 10 个端点","1) GET followings 分页返回关注列表；2) 分组 CRUD 后列表一致；3) 特别关注标记正确；4) 搜索关注支持模糊匹配；5) 分组删除时自动清理关联；6) 关注操作不向 B 站发送任何请求","AUTOSERVER","关注时可选异步查询 B 站 /x/web-interface/card 获取元信息，查询失败不阻塞；TagID 自增分配","分组删除后成员归属验证；特别关注上限；关注列表分页边界","已完成","待验收","未开始","已提交","","plan/2026-02-24_13-59-21-pilminusb-migration.md:200-274;PLAN.md:487-563","model/follow.go + handler/follow.go; 11 follow endpoints + tag CRUD"
"PMB-070","P1","4.2","backend","追番/追剧服务端","创建 BangumiFollow 模型，实现追番列表/追番/取消/状态更新 4 个端点","1) GET bangumi/follow/list 分页返回追番列表；2) add/del 操作正确；3) status/update 状态枚举（1想看/2在看/3已看）切换正确；4) 元数据（title/cover/new_ep_desc）自动填充","AUTOSERVER","season_type 区分番剧/电影/纪录片；元数据来源 pgc API 公开性确认","追番列表排序与筛选；状态流转全路径","已完成","待验收","未开始","已提交","","plan/2026-02-24_13-59-21-pilminusb-migration.md:276-291;PLAN.md:522-582","BangumiFollow model + 4 PGC endpoints in handler/follow.go"
"PMB-080","P1","4.3","frontend","关注与追番客户端迁移","follow.dart/member.dart/video.dart/fav.dart/request_utils.dart 中关注和追番相关方法从 Request() → SelfRequest()","1) followings() 获取列表正常；2) 分组管理 7 个方法操作正常；3) relationMod() 关注/取关/拉黑操作正常；4) pgcAdd/pgcDel/pgcUpdate 追番操作正常；5) favPgc() 追番列表查询正常；6) dynamics.dart followUp() 保持 Request 不受影响","AUTOE2E","relationMod + actionRelationMod 全部走 SelfRequest；followUp 不迁移（动态流仍来自 B 站）","全部迁移方法端到端联调；动态流页面无回归；关注页面 + 追番页面 UI 完整流程","已完成","待验收","未开始","已提交","","plan/2026-02-24_13-59-21-pilminusb-migration.md:293-303;PiliMinusB/lib/http/follow.dart:1;PiliMinusB/lib/http/member.dart:1;PiliMinusB/lib/utils/request_utils.dart:1","follow.dart(1) + member.dart(7) + video.dart(4) + fav.dart(1) migrated; server PgcSuccess for result envelope"
